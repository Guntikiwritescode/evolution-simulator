!function(){var e,n,t,r,a,i,o={75042:function(){},93119:function(e,n,t){"use strict";var r,a,i,o,s=t(2473),u=t(59900),l=t.n(u),f=function(){function e(n){(0,s._)(this,e),this.prng=l()(String(n))}var n=e.prototype;return n.random=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e+this.prng()*(n-e)},n.gaussian=function(e,n){for(var t=this.prng(),r=this.prng();0===t;)t=this.prng();return e+Math.sqrt(-2*Math.log(t))*Math.cos(2*Math.PI*r)*n},n.shuffle=function(e){for(var n=e.length-1;n>0;n--){var t,r=Math.floor(this.prng()*(n+1));t=[e[r],e[n]],e[n]=t[0],e[r]=t[1]}return e},e}(),c=t(5194),v=t(1780),d=t(49360);function h(e,n){return[e[0]-n[0],e[1]-n[1]]}function p(e,n){return[e[0]+n[0],e[1]+n[1]]}function g(e,n){return[e[0]*n,e[1]*n]}function y(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function m(e){var n=y(e);return 0===n?[1,0]:[e[0]/n,e[1]/n]}function S(e,n){return e[0]*n[0]+e[1]*n[1]}function b(e,n,t){var r=m(h(n,e)),a=h(e,t),i=h(n,t),o=S(a,r);return o*S(i,r)>0?null:g(r,-o)}function R(e,n,t){var r=b(e,n,t);if(null===r)return null;var a=h(t,e);return y(h(r,a))}function w(e,n){var t=Math.cos(n),r=Math.sin(n);return[e[0]*t-e[1]*r,e[0]*r+e[1]*t]}function E(e,n,t){return Math.max(Number.MIN_VALUE,e.gaussian(n,t))}function M(e,n,t){return Math.max(0,e.gaussian(n,t))}function P(e){return{id:(0,d.Z)(),speed:{value:1,variance:1},size:{value:1,variance:1},senseRange:{value:1,variance:1},reach:{value:1,variance:1},fleeDistance:{value:1,variance:1},lifeSpan:{value:1,variance:1},energy:500,energyConsumed:0,age:0,pos:[e[0],e[1]],homePos:[e[0],e[1]],foodsEaten:[],movementHistory:[[e[0],e[1]]],state:"active",objective:null}}function C(e,n,t,r,a,i,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:500;return{id:(0,d.Z)(),speed:n,size:t,senseRange:r,reach:a,fleeDistance:i,lifeSpan:o,energy:s,energyConsumed:0,age:0,pos:[e[0],e[1]],homePos:[e[0],e[1]],foodsEaten:[],movementHistory:[[e[0],e[1]]],state:"active",objective:null}}function z(e){var n=[e.homePos[0],e.homePos[1]];return(0,v._)((0,c._)({},P(n)),{id:e.id,speed:(0,c._)({},e.speed),size:(0,c._)({},e.size),senseRange:(0,c._)({},e.senseRange),reach:(0,c._)({},e.reach),fleeDistance:(0,c._)({},e.fleeDistance),lifeSpan:(0,c._)({},e.lifeSpan),energy:e.energy,age:e.age+1})}function x(e){return e.size.value}function _(e){return e.speed.value*e.size.value/10}function T(e){return e.senseRange.value}function I(e){return Math.max(e.reach.value,x(e)/4)}function O(e){var n=x(e),t=_(e);return 1e-4*(n*n*n*t*t+T(e))}function A(e){return Math.max(0,e.energy-e.energyConsumed)}function F(e){var n=e.movementHistory.length;return n<=1?null:e.movementHistory[n-2]}function N(e){var n=null;if(e.objective){var t,r=h(e.objective.pos,e.pos);(1===(t=e.objective.intensity)||3===t||5===t||7===t)&&(r=g(r,-1)),0!==y(r)&&(n=r)}if(!n){var a=F(e);a&&(n=h(e.pos,a)),n&&0!==y(n)||(n=[1,0])}return m(n)}function j(e,n){return y(h(n,e.pos))<=T(e)}function B(e,n){if(y(h(n,e.pos))<=I(e))return!0;var t=F(e);if(!t)return!1;var r=R(e.pos,t,n);return null!==r&&r<=I(e)}function G(e,n){if(!e.objective||n.intensity>e.objective.intensity){e.objective=n;return}if(n.intensity===e.objective.intensity){var t=y(h(e.pos,e.objective.pos));y(h(e.pos,n.pos))<t&&(e.objective=n)}}function D(e,n,t){e.foodsEaten.push({step:n,id:t.getEdibleId(),type:t.getType()})}function V(e){e.state="dead"}function L(e){return"dead"!==e.state}function k(e){return"active"===e.state}function H(e){return"available"!==e.status}(r=i||(i={}))[r.MinorCraving=0]="MinorCraving",r[r.MinorAversion=1]="MinorAversion",r[r.ModerateCraving=2]="ModerateCraving",r[r.ModerateAversion=3]="ModerateAversion",r[r.MajorCraving=4]="MajorCraving",r[r.MajorAversion=5]="MajorAversion",r[r.VitalCraving=6]="VitalCraving",r[r.VitalAversion=7]="VitalAversion",(a=o||(o={})).REPRODUCE="REPRODUCE",a.INIT="INIT",a.PRE="PRE",a.ORIENT="ORIENT",a.MOVE="MOVE",a.ACT="ACT",a.POST="POST",a.FINAL="FINAL";var U=function(){function e(n,t,r){(0,s._)(this,e),this.steps=1,this.creatures=t,this.food=r.map(function(e){return{id:(0,d.Z)(),position:[e[0],e[1]],status:"available",getEdibleId:function(){return this.id},getType:function(){return"food_ball"}}}),this.runPhase(o.INIT,n),this.stepToCompletion(n),this.runPhase(o.FINAL,n)}var n=e.prototype;return n.hasLivingCreatures=function(){return this.creatures.some(function(e){return L(e)})},n.hasActiveCreatures=function(){return this.creatures.some(function(e){return k(e)})},n.getAvailableFood=function(){return this.food.filter(function(e){return!H(e)})},n.markFoodEaten=function(e){var n=this.food.findIndex(function(n){return n.id===e.id});-1!==n&&(this.food[n].status={eaten:this.steps})},n.stepToCompletion=function(e){for(;this.hasActiveCreatures();)this.step(e)},n.runPhase=function(e,n){var t=!0,r=!1,a=void 0;try{for(var i,o=n.behaviours[Symbol.iterator]();!(t=(i=o.next()).done);t=!0)i.value.apply(e,this,n)}catch(e){r=!0,a=e}finally{try{t||null==o.return||o.return()}finally{if(r)throw a}}},n.shuffleCreatures=function(e){e.rng.shuffle(this.creatures)},n.step=function(e){this.steps>=1e6||(this.shuffleCreatures(e),this.runPhase(o.PRE,e),this.runPhase(o.ORIENT,e),this.runPhase(o.MOVE,e),this.runPhase(o.ACT,e),this.runPhase(o.POST,e),this.steps+=1)},e}(),Z=function(){function e(){(0,s._)(this,e)}return e.prototype.apply=function(e,n,t){if(e===o.PRE){var r=!0,a=!1,i=void 0;try{for(var s,u=n.creatures[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var l=s.value;L(l)&&(l.objective=null)}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}}},e}(),q=function(){function e(){(0,s._)(this,e)}return e.prototype.reproduce=function(n,t){var r=[],a=!0,i=!1,o=void 0;try{for(var s,u=n[Symbol.iterator]();!(a=(s=u.next()).done);a=!0){var l=s.value;L(l)&&(e.willReproduce(l)&&r.push(function(e,n){var t=[e.homePos[0],e.homePos[1]];return(0,v._)((0,c._)({},P(t)),{speed:{value:E(n,e.speed.value,e.speed.variance),variance:e.speed.variance},size:{value:E(n,e.size.value,e.size.variance),variance:e.size.variance},senseRange:{value:M(n,e.senseRange.value,e.senseRange.variance),variance:e.senseRange.variance},reach:{value:E(n,e.reach.value,e.reach.variance),variance:e.reach.variance},fleeDistance:{value:M(n,e.fleeDistance.value,e.fleeDistance.variance),variance:e.fleeDistance.variance},lifeSpan:{value:E(n,e.lifeSpan.value,e.lifeSpan.variance),variance:e.lifeSpan.variance},energy:e.energy})}(l,t.rng)),r.push(z(l)))}}catch(e){i=!0,o=e}finally{try{a||null==u.return||u.return()}finally{if(i)throw o}}return r},e.willReproduce=function(e){return e.foodsEaten.length>1},e}(),W=function(){function e(){(0,s._)(this,e)}return e.prototype.reproduce=function(e,n){var t=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;if(L(u)){if(u.foodsEaten.length>1){var l=z(u);l.age=0,t.push(l)}t.push(z(u))}}}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return t},e}(),X=function(){function e(n,t,r){(0,s._)(this,e),this.stage=n,this.rng=new f(t),this.foodPerGeneration=r,this.generations=[],this.behaviours=[new Z],this.reproductionBehaviour=new q}var n=e.prototype;return n.addBehaviour=function(e){this.behaviours.push(e)},n.setReproductionBehaviour=function(e){this.reproductionBehaviour=e},n.getRandomLocation=function(){return this.stage.getRandomLocation(this.rng)},n.getRandomFloat=function(e,n){return this.rng.random(e,n)},n.getRandomGaussian=function(e,n){return this.rng.gaussian(e,n)},n.generateFood=function(){for(var e=this.generations.length,n=Math.round(this.foodPerGeneration.get(e)),t=[],r=0;r<n;r++)t.push(this.getRandomLocation());return t},n.execReproduction=function(e){return this.reproductionBehaviour.reproduce(e,this)},n.run=function(e,n){for(var t=new U(this,e,this.generateFood()),r=t.hasLivingCreatures(),a=1;a<n&&r;a++){var i=this.execReproduction(t.creatures);this.generations.push(t),r=(t=new U(this,i,this.generateFood())).hasLivingCreatures()}this.generations.push(t)},n.runSingleGeneration=function(e){return new U(this,e,this.generateFood())},e}(),J=function(){function e(n){(0,s._)(this,e),this.size=n}var n=e.prototype;return n.getEdges=function(){var e=this.size;return[[[0,0],[e,0]],[[e,0],[e,e]],[[e,e],[0,e]],[[0,e],[0,0]]]},n.canMoveTo=function(e){return e[0]>=0&&e[1]>=0&&e[0]<=this.size&&e[1]<=this.size},n.getCenter=function(){return[.5*this.size,.5*this.size]},n.getRandomLocation=function(e){return[e.random(0,this.size),e.random(0,this.size)]},n.getNearestEdgePoint=function(e){var n=.5*this.size,t=e[0]>n?this.size:0,r=e[1]>n?this.size:0;return Math.abs(t-e[0])<Math.abs(r-e[1])?[t,e[1]]:[e[0],r]},n.constrainWithin=function(e){return[Math.max(0,Math.min(this.size,e[0])),Math.max(0,Math.min(this.size,e[1]))]},e}(),K=t(60076),Q=function(){function e(n){(0,s._)(this,e),this.pts=(0,K._)(n)}return e.prototype.get=function(e){var n,t,r,a=this.pts.length;if(0===a)return 0;var i=this.pts[0][0],o=this.pts[a-1][0];if(e<i)return this.pts[0][1];if(e>=o)return this.pts[a-1][1];for(var s=0,u=0;u<a&&(s=u,!(e<this.pts[u][0]));u++);var l=this.pts[s-1][0],f=this.pts[s][0];return l===f?this.pts[s][1]:(n=this.pts[s-1][1],t=this.pts[s][1],n*(1-(r=(e-l)/(f-l)))+t*r)},e}(),Y=function(){function e(){(0,s._)(this,e)}return e.prototype.apply=function(e,n,t){if(e===o.MOVE){var r=!0,a=!1,i=void 0;try{for(var s,u=n.creatures[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var l=s.value;if(k(l)){var f=l.pos,c=N(l),v=p(f,g(c,_(l))),d=t.stage.constrainWithin(v);!function(e,n){e.pos=[n[0],n[1]],e.movementHistory.push([n[0],n[1]]);var t=O(e);e.energyConsumed+=t,0>=A(e)&&(e.state="dead")}(l,d)}}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}}},e}(),$=function(){function e(){(0,s._)(this,e)}return e.prototype.apply=function(e,n,t){if(e===o.ORIENT){var r=!0,a=!1,s=void 0;try{for(var u,l=n.creatures[Symbol.iterator]();!(r=(u=l.next()).done);r=!0){var f=u.value;if(k(f)){var c=t.getRandomFloat(-Math.PI/4,Math.PI/4),v=N(f),d=w(v,c),h=p(f.pos,d);t.stage.canMoveTo(h)?G(f,{pos:h,intensity:i.MinorCraving,reason:"wandering"}):G(f,{pos:t.stage.getCenter(),intensity:i.MinorCraving,reason:"wandering"})}}}catch(e){a=!0,s=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw s}}}},e}(),ee=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.8;(0,s._)(this,e),this.sizeRatio=n}var n=e.prototype;return n.forPredPreyPair=function(e,n){for(var t=1;t<e.length;t++)if(k(e[t]))for(var r=0;r<t;r++){var a=e[r],i=e[t];if(k(a)&&k(i)){var o=void 0,s=void 0;x(a)>x(i)?(o=a,s=i):(o=i,s=a),k(o)&&k(s)&&(x(o)*this.sizeRatio<x(s)||n(o,s))}}},n.apply=function(e,n,t){if(e===o.ORIENT){var r=new Map;this.forPredPreyPair(n.creatures,function(e,n){if(j(n,a=e.pos)&&y(h(n.pos,a))<n.fleeDistance.value){var a,o=t.getRandomFloat(-Math.PI/4,Math.PI/4),s=h(e.pos,n.pos),u=p(n.pos,w(s,o));G(n,{pos:u,intensity:i.VitalAversion,reason:"running away"})}if(j(e,n.pos)){var l=r.get(e.id);if(!(void 0!==l&&l<=_(n))){r.set(e.id,_(n));var f=0===e.foodsEaten.length?i.VitalCraving:1===e.foodsEaten.length?i.ModerateCraving:i.MinorCraving;G(e,{pos:n.pos,intensity:f,reason:"see prey"})}}})}if(e===o.ACT){var a=n.steps;this.forPredPreyPair(n.creatures,function(e,n){B(e,n.pos)&&(D(e,a,{getEdibleId:function(){return n.id},getType:function(){return"creature"}}),V(n))})}},e}();function en(e){return k(e)&&e.foodsEaten.length<2}function et(e,n){var t=null,r=1/0,a=!0,i=!1,o=void 0;try{for(var s,u=n[Symbol.iterator]();!(a=(s=u.next()).done);a=!0){var l=s.value,f=y(h(l.position,e.pos));!isNaN(f)&&f<r&&(r=f,t=l)}}catch(e){i=!0,o=e}finally{try{a||null==u.return||u.return()}finally{if(i)throw o}}return t}var er=function(){function e(){(0,s._)(this,e)}return e.prototype.apply=function(e,n,t){if(e===o.ORIENT){var r=n.getAvailableFood(),a=!0,s=!1,u=void 0;try{for(var l,f=n.creatures[Symbol.iterator]();!(a=(l=f.next()).done);a=!0){var c=l.value;if(en(c)){var v=et(c,r);if(v&&j(c,v.position)){var d=0===c.foodsEaten.length?i.VitalCraving:1===c.foodsEaten.length?i.ModerateCraving:i.MinorCraving;G(c,{pos:v.position,intensity:d,reason:"see food"})}}}}catch(e){s=!0,u=e}finally{try{a||null==f.return||f.return()}finally{if(s)throw u}}}if(e===o.ACT){var h=n.getAvailableFood(),p=!0,g=!1,y=void 0;try{for(var m,S=n.creatures[Symbol.iterator]();!(p=(m=S.next()).done);p=!0)!function(){var e=m.value;if(en(e)){var t=et(e,h);t&&!H(t)&&B(e,t.position)&&(D(e,n.steps,t),n.markFoodEaten(t),h=h.filter(function(e){return e.id!==t.id}))}}()}catch(e){g=!0,y=e}finally{try{p||null==S.return||S.return()}finally{if(g)throw y}}}},e}(),ea=function(){function e(){(0,s._)(this,e)}return e.prototype.apply=function(e,n,t){if(e===o.ORIENT){var r=!0,a=!1,s=void 0;try{for(var u,l=n.creatures[Symbol.iterator]();!(r=(u=l.next()).done);r=!0){var f=u.value;if(k(f)){var c=function(e){var n=e.foodsEaten.length;return 0===n?null:n>1?{pos:e.homePos,intensity:i.MajorCraving,reason:"satisfied"}:function(e){var n,t=y(h(e.homePos,e.pos)),r=O(e),a=_(e);if(0===a)return null;var o=r>0?A(e)/r-t/a:1/0;return null===(n=o>10?null:o>5?i.MinorCraving:o>0?i.MajorCraving:i.VitalCraving)?null:{pos:e.homePos,intensity:n,reason:"low energy"}}(e)}(f);c&&(G(f,c),B(f,f.homePos))&&(f.state="asleep")}}}catch(e){a=!0,s=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw s}}}},e}(),ei=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];(0,s._)(this,e),this.disabledEdges=n}var n=e.prototype;return n.setHome=function(e,n){for(var t=n.stage.getEdges(),r=null,a=1/0,i=0;i<t.length;i++)if(!this.disabledEdges.includes(i)){var o=R(t[i][0],t[i][1],e.pos);null!==o&&o<a&&(a=o,r=t[i])}if(r){var s=b(r[0],r[1],e.pos);s&&(e.homePos=p(r[0],s))}else e.homePos=[Number.MAX_VALUE,0]},n.apply=function(e,n,t){if(e===o.PRE){var r=!0,a=!1,i=void 0;try{for(var s,u=n.creatures[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var l=s.value;L(l)&&this.setHome(l,t)}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}}},e}(),eo=function(){function e(){(0,s._)(this,e)}return e.prototype.apply=function(e,n,t){if(e===o.INIT){var r=!0,a=!1,i=void 0;try{for(var s,u=n.creatures[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var l=s.value;0===_(l)&&V(l)}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}}if(e===o.POST&&0===n.getAvailableFood().length){var f=!0,c=!1,v=void 0;try{for(var d,h=n.creatures[Symbol.iterator]();!(f=(d=h.next()).done);f=!0){var p=d.value;k(p)&&p.foodsEaten.length<1&&V(p)}}catch(e){c=!0,v=e}finally{try{f||null==h.return||h.return()}finally{if(c)throw v}}}if(e===o.FINAL){var g=!0,y=!1,m=void 0;try{for(var S,b=n.creatures[Symbol.iterator]();!(g=(S=b.next()).done);g=!0){var R=S.value;L(R)&&R.foodsEaten.length<1&&V(R)}}catch(e){y=!0,m=e}finally{try{g||null==b.return||b.return()}finally{if(y)throw m}}}},e}();function es(e,n){if(e.length<=1)return 0;var t=0,r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value-n;t+=u*u}}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return t/(e.length-1)}var eu={trainingGenerations:50,transferGenerations:25,numRuns:30,populationSize:50,baseSeed:1e3,env1:{worldSize:500,foodPerGeneration:50,disabledEdges:[]},env2:{worldSize:800,foodPerGeneration:30,disabledEdges:[2,3]},gridSearchSpeedSize:[4,7,10,13,16,19],gridSearchSense:[5,10,15,20,25,30]},el={speed:10,size:10,senseRange:20,reach:1,fleeDistance:1e12,lifeSpan:1e4,variance:.5,energy:500};function ef(e,n,t){var r=new X(new J(e.worldSize),n,new Q([[0,e.foodPerGeneration]]));return r.addBehaviour(new Y),r.addBehaviour(new $),r.addBehaviour(new ee(.8)),r.addBehaviour(new er),r.addBehaviour(new ea),r.addBehaviour(new ei(e.disabledEdges)),r.addBehaviour(new eo),t||r.setReproductionBehaviour(new W),r}function ec(e,n,t){e.run(n,t);for(var r=[],a=0;a<e.generations.length;a++)r.push(function(e,n){var t=e.creatures,r=t.length;if(0===r)return{generation:n,population:0,meanFoodEaten:0,survivalRate:0,reproductionRate:0,meanSpeed:0,meanSize:0,meanSenseRange:0,speedVariance:0,sizeVariance:0,senseRangeVariance:0,traitDiversity:0,creaturesEaten:0,computationSteps:e.steps};var a=0,i=0,o=0,s=0,u=0,l=0,f=0,c=[],v=[],d=[],h=!0,p=!1,g=void 0;try{for(var y,m=t[Symbol.iterator]();!(h=(y=m.next()).done);h=!0){var S=y.value,b=S.foodsEaten.length;a+=b,L(S)&&i++,q.willReproduce(S)&&o++;var R=S.speed.value,w=S.size.value,E=S.senseRange.value;s+=R,u+=w,l+=E,c.push(R),v.push(w),d.push(E);var M=!0,P=!1,C=void 0;try{for(var z,x=S.foodsEaten[Symbol.iterator]();!(M=(z=x.next()).done);M=!0){var _=z.value;"creature"===_.type&&f++}}catch(e){P=!0,C=e}finally{try{M||null==x.return||x.return()}finally{if(P)throw C}}}}catch(e){p=!0,g=e}finally{try{h||null==m.return||m.return()}finally{if(p)throw g}}var T=s/r,I=u/r,O=l/r,A=es(c,T),F=es(v,I),N=es(d,O),j=T>0?A/(T*T):0,B=I>0?F/(I*I):0,G=O>0?N/(O*O):0;return{generation:n,population:r,meanFoodEaten:a/r,survivalRate:i/r,reproductionRate:o/r,meanSpeed:T,meanSize:I,meanSenseRange:O,speedVariance:A,sizeVariance:F,senseRangeVariance:N,traitDiversity:j+B+G,creaturesEaten:f,computationSteps:e.steps}}(e.generations[a],a));return{metrics:r,finalCreatures:e.generations[e.generations.length-1].creatures.filter(function(e){return L(e)})}}function ev(e,n){return n.execReproduction(e)}var ed=!1;self.onmessage=function(e){var n=e.data;if("cancel"===n.type){ed=!0;return}if("start"===n.type){ed=!1;var t,r=null!==(t=n.config)&&void 0!==t?t:eu;try{var a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:eu,n=arguments.length>1?arguments[1]:void 0,t=arguments.length>2?arguments[2]:void 0,r=Date.now(),a=Math.pow(e.gridSearchSpeedSize.length,2)*e.gridSearchSense.length,i=a+4*e.numRuns,o=0;function s(t,r,a,s){n&&n({phase:t,currentRun:r,totalRuns:e.numRuns,currentGeneration:a,totalGenerations:s,percentComplete:o/i*100})}var u=function(e,n,t,r,a,i,o){var s,u,l,f,c=e.length*n.length*t.length,v=[],d=null,h=0,p=!0,g=!1,y=void 0;try{for(var m,S=e[Symbol.iterator]();!(p=(m=S.next()).done);p=!0){var b=m.value,R=!0,w=!1,E=void 0;try{for(var M,P=n[Symbol.iterator]();!(R=(M=P.next()).done);R=!0){var z=M.value,x=!0,_=!1,T=void 0;try{for(var I,O=t[Symbol.iterator]();!(x=(I=O.next()).done);x=!0){var A=I.value,F=function(e,n,t,r,a,i){var o=new J(r.worldSize),s=new Q([[0,r.foodPerGeneration]]),u=new X(o,"gs-eval-".concat(i,"-").concat(e,"-").concat(n,"-").concat(t),s);u.addBehaviour(new Y),u.addBehaviour(new $),u.addBehaviour(new ee(.8)),u.addBehaviour(new er),u.addBehaviour(new ea),u.addBehaviour(new ei(r.disabledEdges)),u.addBehaviour(new eo),u.setReproductionBehaviour(new W);for(var l=function(e){return{value:e,variance:0}},f=[],c=0;c<a;c++){var v=u.getRandomLocation(),d=o.getNearestEdgePoint(v);f.push(C(d,l(e),l(n),l(t),l(el.reach),l(el.fleeDistance),l(el.lifeSpan),el.energy))}var h=u.runSingleGeneration(f),p=0,g=0,y=!0,m=!1,S=void 0;try{for(var b,R=h.creatures[Symbol.iterator]();!(y=(b=R.next()).done);y=!0){var w=b.value;p+=w.foodsEaten.length,w.foodsEaten.length>0&&g++}}catch(e){m=!0,S=e}finally{try{y||null==R.return||R.return()}finally{if(m)throw S}}return{meanFood:h.creatures.length>0?p/h.creatures.length:0,survived:g}}(b,z,A,r,a,i),N={speed:b,size:z,senseRange:A,meanFoodEaten:F.meanFood,populationSurvived:F.survived};v.push(N),(!d||N.meanFoodEaten>d.meanFoodEaten)&&(d=N),h++,o&&o(h,c)}}catch(e){_=!0,T=e}finally{try{x||null==O.return||O.return()}finally{if(_)throw T}}}}catch(e){w=!0,E=e}finally{try{R||null==P.return||P.return()}finally{if(w)throw E}}}}catch(e){g=!0,y=e}finally{try{p||null==S.return||S.return()}finally{if(g)throw y}}return{entries:v,bestSpeed:null!==(s=null==d?void 0:d.speed)&&void 0!==s?s:el.speed,bestSize:null!==(u=null==d?void 0:d.size)&&void 0!==u?u:el.size,bestSenseRange:null!==(l=null==d?void 0:d.senseRange)&&void 0!==l?l:el.senseRange,bestFitness:null!==(f=null==d?void 0:d.meanFoodEaten)&&void 0!==f?f:0}}(e.gridSearchSpeedSize,e.gridSearchSpeedSize,e.gridSearchSense,e.env1,e.populationSize,e.baseSeed,function(e,n){o=e,s("grid-search",0,e,n)});if(null==t?void 0:t())return null;o=a;for(var l=[],f=0;f<e.numRuns;f++){if(null==t?void 0:t())return null;var c=e.baseSeed+f;s("et-training",f+1,0,e.trainingGenerations);var v=ef(e.env1,"et-train-".concat(c),!0),d=function(e,n){for(var t=function(e,n){return{value:e,variance:n}},r=[],a=e.stage,i=0;i<n;i++){var o=e.getRandomLocation(),s=a.getNearestEdgePoint(o);r.push(C(s,t(el.speed,el.variance),t(el.size,el.variance),t(el.senseRange,el.variance),t(el.reach,0),t(el.fleeDistance,0),t(el.lifeSpan,0),el.energy))}return r}(v,e.populationSize),h=ec(v,d,e.trainingGenerations);o=a+4*f+1,s("et-transfer",f+1,0,e.transferGenerations);var p=ef(e.env2,"et-transfer-".concat(c),!0),g=ev(h.finalCreatures,p),y=ec(p,g,e.transferGenerations);l.push({seed:c,trainingMetrics:h.metrics,transferMetrics:y.metrics,finalCreatures:y.finalCreatures}),o=a+4*f+2}for(var m=[],S=0;S<e.numRuns;S++){if(null==t?void 0:t())return null;var b=e.baseSeed+S;s("gs-training",S+1,0,e.trainingGenerations);var R=ef(e.env1,"gs-train-".concat(b),!1),w=function(e,n,t,r,a){for(var i=function(e){return{value:e,variance:0}},o=[],s=e.stage,u=0;u<n;u++){var l=e.getRandomLocation(),f=s.getNearestEdgePoint(l);o.push(C(f,i(t),i(r),i(a),i(el.reach),i(el.fleeDistance),i(el.lifeSpan),el.energy))}return o}(R,e.populationSize,u.bestSpeed,u.bestSize,u.bestSenseRange),E=ec(R,w,e.trainingGenerations);o=a+2*e.numRuns+2*S+1,s("gs-transfer",S+1,0,e.transferGenerations);var M=ef(e.env2,"gs-transfer-".concat(b),!1),P=ev(E.finalCreatures,M),z=ec(M,P,e.transferGenerations);m.push({seed:b,trainingMetrics:E.metrics,transferMetrics:z.metrics,finalCreatures:z.finalCreatures}),o=a+2*e.numRuns+2*S+2}return{config:e,gridSearchResult:u,etRuns:l,gsRuns:m,wallClockMs:Date.now()-r}}(r,function(e){self.postMessage({type:"progress",data:e})},function(){return ed});ed?self.postMessage({type:"cancelled"}):a&&self.postMessage({type:"complete",data:a})}catch(e){self.postMessage({type:"error",error:e instanceof Error?e.message:String(e)})}}}}},s={};function u(e){var n=s[e];if(void 0!==n)return n.exports;var t=s[e]={id:e,loaded:!1,exports:{}},r=!0;try{o[e].call(t.exports,t,t.exports,u),r=!1}finally{r&&delete s[e]}return t.loaded=!0,t.exports}u.m=o,u.x=function(){var e=u.O(void 0,[610],function(){return u(93119)});return u.O(e)},u.amdD=function(){throw Error("define cannot be used indirect")},u.amdO={},e=[],u.O=function(n,t,r,a){if(t){a=a||0;for(var i=e.length;i>0&&e[i-1][2]>a;i--)e[i]=e[i-1];e[i]=[t,r,a];return}for(var o=1/0,i=0;i<e.length;i++){for(var t=e[i][0],r=e[i][1],a=e[i][2],s=!0,l=0;l<t.length;l++)o>=a&&Object.keys(u.O).every(function(e){return u.O[e](t[l])})?t.splice(l--,1):(s=!1,a<o&&(o=a));if(s){e.splice(i--,1);var f=r();void 0!==f&&(n=f)}}return n},u.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return u.d(n,{a:n}),n},u.d=function(e,n){for(var t in n)u.o(n,t)&&!u.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},u.f={},u.e=function(e){return Promise.all(Object.keys(u.f).reduce(function(n,t){return u.f[t](e,n),n},[]))},u.u=function(e){return"static/chunks/"+e+".228e2bef95ba6aa2.js"},u.miniCssF=function(e){},u.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},u.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},u.tt=function(){return void 0===n&&(n={createScriptURL:function(e){return e}},"undefined"!=typeof trustedTypes&&trustedTypes.createPolicy&&(n=trustedTypes.createPolicy("nextjs#bundler",n))),n},u.tu=function(e){return u.tt().createScriptURL(e)},u.p="/_next/",t={666:1},u.f.i=function(e,n){t[e]||importScripts(u.tu(u.p+u.u(e)))},a=(r=self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push.bind(r),r.push=function(e){var n=e[0],r=e[1],i=e[2];for(var o in r)u.o(r,o)&&(u.m[o]=r[o]);for(i&&i(u);n.length;)t[n.pop()]=1;a(e)},i=u.x,u.x=function(){return u.e(610).then(i)},_N_E=u.x()}();